webpackJsonp([1],{0:function(t,e){},"1/oy":function(t,e){},"6Q7+":function(t,e){},"9M+g":function(t,e){},Bc8N:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIKICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgoKICA8cG9seWdvbiBwb2ludHM9IjAsMCAxMSw2IDAsMTIiIGZpbGw9ImxpZ2h0Z3JlZW4iIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiLz4KPC9zdmc+Cg=="},Fphx:function(t,e){},Gjb1:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCA4IDgiPgogIDxwYXRoIGZpbGw9IndoaXRlIgogICAgICAgIHRyYW5zZm9ybT0ic2NhbGUoLTEsMSkgdHJhbnNsYXRlKC04LDApIgogICAgICAgIGQ9Ik00IDBjLTIuMiAwLTQgMS44LTQgNHMxLjggNCA0IDRjMS4xIDAgMi4xMi0uNDMgMi44NC0xLjE2bC0uNzItLjcyYy0uNTQuNTQtMS4yOS44OC0yLjEzLjg4LTEuNjYgMC0zLTEuMzQtMy0zczEuMzQtMyAzLTNjLjgzIDAgMS41NS4zNiAyLjA5LjkxbC0xLjA5IDEuMDloM3YtM2wtMS4xOSAxLjE5Yy0uNzItLjcyLTEuNzEtMS4xOS0yLjgxLTEuMTl6IiAvPgo8L3N2Zz4="},IXiI:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCA4IDgiPgogIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNNCAwYy0xLjY1IDAtMyAxLjM1LTMgM2gtMWwxLjUgMiAxLjUtMmgtMWMwLTEuMTEuODktMiAyLTJ2LTF6bTIuNSAxbC0xLjUgMmgxYzAgMS4xMS0uODkgMi0yIDJ2MWMxLjY1IDAgMy0xLjM1IDMtM2gxbC0xLjUtMnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMSkiIC8+Cjwvc3ZnPg=="},Id91:function(t,e){},Jmt5:function(t,e){},KHPl:function(t,e){t.exports={padZeros:function(t,e){var i=(e+"").length,a=Math.max(0,t-i);return"0".repeat(a)+e},timerFormat:function(t){var e=Math.floor(t/6e4),i=Math.floor(t%6e4/1e3),a=t%1e3;return this.padZeros(2,e)+":"+this.padZeros(2,i)+":"+this.padZeros(3,a)},validateObjectSchema:function(t,e){var i=[];return e.forEach(function(e){t.hasOwnProperty(e)||i.push(e)}),0===i.length?{valid:!0,missing:i}:{valid:!1,missing:i}},meterToPixels:function(t){return Math.round(10*t)},pixelToMeters:function(t){return t/10}}},N3eC:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),s=i("e6fC"),r=i("8+8L"),o=i("/ocq"),n=i("NYxO"),l=i("pFYg"),c=i.n(l),d=i("KHPl"),h=i.n(d),u=i("V8gR"),p=i.n(u),g=["playing","paused","stopped"],v=["live","replay"],f={updateEntity:function(t,e){var i=p.a.getStateObjectFromIdentifier(t,e.entityIdentifier);for(var a in e.payload)i.hasOwnProperty(a)&&(i[a]=e.payload[a])},updateRecordings:function(t,e){if("object"!==(void 0===e?"undefined":c()(e)))throw new Error("recordings must be an Array");t.recordings=e},updateReplayMode:function(t,e){if(!(g.indexOf(e)>=0))throw new Error(e+" is not a valid replay mode");t.replay.mode=e},updateReplayRecording:function(t,e){t.replay.selectedRecording=e},updateReplayRecordingActiveFrame:function(t,e){var i=t.replay.selectedRecording,a=i.frames,s=Number.POSITIVE_INFINITY,r=-1,o=i.start+e;if(i.start+e>i.end||e<0)throw new Error("newPosition is out of bounds of selectedRecordings: "+e);a.forEach(function(t,e){var i=Math.abs(o-t.timestamp);i<s&&(s=i,r=e)}),t.replay.activeFrame=a[r]},updateReplayDelta:function(t,e){t.replay.delta=e},updateGlobalLoader:function(t,e){var i=h.a.validateObjectSchema(e,["show","message"]);if(!i.valid)throw new Error("Missing properties: "+i.missing);t.globalLoader.message=e.message,t.globalLoader.show=e.show},updateViewDataSource:function(t,e){if(!(v.indexOf(e)>=0))throw new Error(e+" is not a valid data source");t.viewDataSource=e}},m=i("//Fk"),b=i.n(m),y={fetchRecordings:function(t){return new b.a(function(e,i){a.a.http.get("recordings").then(function(i){t.commit("updateRecordings",i.body),e()},function(t){i(t)})})},fetchReplayRecording:function(t,e){return new b.a(function(i,s){a.a.http.get("recording/"+e).then(function(e){t.commit("updateReplayRecording",e.body),i()},function(t){s(t)})})},resetStats:function(){return new b.a(function(t,e){var i=p.a.getApiRouteFromIdentifier("resetStats");a.a.http.get(i).then(function(e){t()},function(t){e(t)})})},switchRecordingStatus:function(t,e){return new b.a(function(i,s){var r=p.a.getApiRouteFromIdentifier(e);a.a.http.get(r).then(function(e){t.commit("updateEntity",{entityIdentifier:"appState",payload:e.body}),i()},function(t){s(t)})})},startRefreshingEntity:function(t,e){var i=p.a.getStateObjectFromIdentifier(t.state,e);i.refresh||(i.refresh=!0,t.dispatch("entityRefreshTick",e))},stopRefreshingEntity:function(t,e){p.a.getStateObjectFromIdentifier(t.state,e).refresh=!1},entityRefreshTick:function(t,e){var i=p.a.getConfigFromIdentifier(e),s=p.a.getStateObjectFromIdentifier(t.state,e),r=p.a.getApiRouteFromIdentifier(e);a.a.http.get(r).then(function(a){var r=a.body,o=h.a.validateObjectSchema(r,i.requiredProperties);o.valid?(t.commit("updateEntity",{entityIdentifier:e,payload:r}),s.refresh&&window.setTimeout(function(i){t.dispatch("entityRefreshTick",e)},i.refreshInterval)):console.log(new Error("Missing properties: "+o.missing.toString()))},function(t){console.log(t)})}};a.a.use(n.a);var w=new n.a.Store({state:{apiRoot:"/",appState:{refresh:!1,activeRecording:null,connected:!1,recording:!1,presentationMode:!1},liveStats:{refresh:!1,timestamp:0,steerAngle:0,pathMiddleX:0,pathMiddleY:0,vehicleX:0,vehicleY:0,vehicleVelocityX:0,vehicleVelocityY:0,vehicleRotation:0,frontwheelLeftRotation:0,frontwheelRightRotation:0,observations:[],clusters:{},trajectoryPrimitives:[],trajectoryHash:0,trajectory:[]},replay:{mode:"stopped",delta:0,selectedRecording:null,activeFrame:null},recordings:[],globalLoader:{show:!1,message:"Loading..."},viewDataSource:"live"},mutations:f,actions:y}),x=i("Dd8w"),S=i.n(x),I=i("/V0p"),M={name:"RecordingControls",data:function(){return{correctPassphraseHashed:"c4ae69280ce2f63b5983bfd58d4e80395b1a33a77d54dca7d3db146db4a701b803e45a088a4fe849d78ec5ad703f8856aea0285bbebbefc5285ceddef4c7d8f7",enteredPassphrase:"",showPrompt:!1,error:!1,action:"record",hasher:new I.SHA512}},computed:S()({clipPosition:function(){return this.appState&&this.appState.recording?(new Date).getTime()-this.appState.activeRecording.start:0},counterValue:function(){return h.a.timerFormat(this.clipPosition)}},Object(n.b)({appState:"appState"})),methods:{triggerRecording:function(){this.appState.recording||(this.appState.presentationMode?(this.action="record",this.showPrompt=!0):this.record())},triggerStop:function(){this.appState.recording&&(this.appState.presentationMode?(this.action="stop",this.showPrompt=!0):this.stop())},record:function(){this.$store.dispatch("switchRecordingStatus","start").then(null,function(t){console.log(t)})},stop:function(){var t=this;this.$store.dispatch("switchRecordingStatus","stop").then(function(e){t.$router.push("/recordings")},function(t){console.log(t)})},checkPassphrase:function(){if(this.hasher.hex(this.enteredPassphrase)===this.correctPassphraseHashed){switch(this.action){case"record":this.record();break;case"stop":default:this.stop()}this.showPrompt=!1}else this.error=!0;this.enteredPassphrase=""}}},L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-row",{attrs:{"align-h":"end"}},[t.appState.recording?i("b-col",{staticClass:"pr-0",attrs:{cols:"auto"}},[i("code",{staticClass:"button-indent"},[t._v(t._s(t.counterValue))])]):t._e(),t._v(" "),i("b-col",{attrs:{cols:"auto"}},[i("b-button-group",[i("b-button",{attrs:{disabled:!t.appState.recording},on:{click:t.triggerStop}},[i("span",{staticClass:"panelIcon stop"})]),t._v(" "),i("b-button",{attrs:{pressed:t.appState.recording},on:{click:t.triggerRecording}},[i("span",{staticClass:"panelIcon record"})])],1)],1)],1),t._v(" "),i("b-modal",{attrs:{title:"Enter Passphrase","no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":""},model:{value:t.showPrompt,callback:function(e){t.showPrompt=e},expression:"showPrompt"}},[t.error?i("p",{staticClass:"errorMessage"},[t._v("Wrong passphrase. Please try again.")]):t._e(),t._v(" "),i("b-form-input",{attrs:{type:"password"},model:{value:t.enteredPassphrase,callback:function(e){t.enteredPassphrase=e},expression:"enteredPassphrase"}}),t._v(" "),i("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("b-button",{attrs:{variant:"secondary"},on:{click:t.checkPassphrase}},[t._v("Ok")])],1)],1)],1)},staticRenderFns:[]};var C=i("VU/8")(M,L,!1,function(t){i("6Q7+")},"data-v-622baed5",null).exports,R=i("GDE4"),j=i.n(R),_={name:"ReplayControls",props:{clipID:String},data:function(){return{lastTickAt:0,position:0,sliderOptions:{tooltip:"hover",processStyle:{backgroundColor:"rgba(190,22,33,1)"},tooltipStyle:{backgroundColor:"rgba(50,50,50,1)",borderColor:"rgba(50,50,50,1)"},max:100}}},computed:Object(n.b)({replayGlobals:"replay",counterValue:function(){return h.a.timerFormat(this.position)}}),watch:{position:function(t,e){this.$store.commit("updateReplayDelta",t-e),this.$store.commit("updateReplayRecordingActiveFrame",t)}},mounted:function(){var t=this;this.$store.commit("updateGlobalLoader",{show:!0,message:"Loading clip..."}),this.position=0,this.$store.dispatch("fetchReplayRecording",this.clipID).then(function(e){var i=t.replayGlobals.selectedRecording;t.sliderOptions.max=i.end-i.start,t.$store.commit("updateReplayRecordingActiveFrame",t.position),t.$store.commit("updateGlobalLoader",{show:!1,message:""})},function(t){console.log(t)})},methods:{playTick:function(){switch(this.replayGlobals.mode){case"playing":var t=(new Date).getTime(),e=this.lastTickAt?t-this.lastTickAt:0;e<this.sliderOptions.max-this.position?(this.position+=e,this.lastTickAt=t,window.setTimeout(this.playTick,100)):(this.pause(),this.position=this.sliderOptions.max);break;case"paused":this.lastTickAt=0}},play:function(){"playing"!==this.replayGlobals.mode&&(this.$store.commit("updateReplayMode","playing"),this.playTick())},pause:function(){"playing"===this.replayGlobals.mode&&this.$store.commit("updateReplayMode","paused")},stop:function(){0!==this.position&&(this.$store.commit("updateReplayMode","stopped"),this.position=0,this.lastTickAt=0)}},components:{vueSlider:j.a}},P={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{sm:"auto"}},[a("p",[t._v("Replay clip: "),a("code",[t._v(t._s(t.clipID))])])])],1),t._v(" "),a("b-row",{attrs:{"align-h":"start"}},[a("b-col",{attrs:{order:"0",cols:"auto"}},[a("b-button-group",[a("b-button",{attrs:{pressed:"playing"===t.replayGlobals.mode},on:{click:t.play}},[a("img",{attrs:{src:i("Bc8N")}})]),t._v(" "),a("b-button",{attrs:{disabled:"playing"!==t.replayGlobals.mode},on:{click:t.pause}},[a("span",{staticClass:"panelIcon pause"})]),t._v(" "),a("b-button",{attrs:{disabled:0===t.position},on:{click:t.stop}},[a("span",{staticClass:"panelIcon stop"})])],1)],1),t._v(" "),a("b-col",{staticClass:"p-0",attrs:{order:"1",col:"",sm:"auto"}},[a("code",{staticClass:"button-indent"},[t._v("\n        "+t._s(t.counterValue)+"\n      ")])]),t._v(" "),a("b-col",{attrs:{order:"3","order-sm":"2",cols:"12",sm:""}},[a("vue-slider",t._b({staticClass:"tape",attrs:{formatter:t.counterValue},model:{value:t.position,callback:function(e){t.position=e},expression:"position"}},"vue-slider",t.sliderOptions,!1))],1),t._v(" "),a("b-col",{staticClass:"pl-0",attrs:{order:"2","order-sm":"3",cols:"3",sm:"auto"}},[a("b-button",{attrs:{variant:"secondary",to:"/dashboard/live"}},[a("img",{attrs:{src:i("frZY")}})])],1)],1)],1)},staticRenderFns:[]};var A=i("VU/8")(_,P,!1,function(t){i("XySv")},"data-v-b5ab097c",null).exports,T=i("xLKd"),k=i.n(T),D=i("bOdI"),O=i.n(D),V={name:"switches",props:{typeBold:{default:!1},value:{default:!1},disabled:{default:!1},label:{default:""},textEnabled:{default:""},textDisabled:{default:""},color:{default:"default"},theme:{default:"default"},emitOnMount:{default:!0}},mounted:function(){this.emitOnMount&&this.$emit("input",this.value)},methods:{trigger:function(t){this.$emit("input",t.target.checked)}},computed:{classObject:function(){var t,e=this.color,i=this.value,a=this.theme,s=this.typeBold,r=this.disabled;return t={"vue-switcher":!0},O()(t,"vue-switcher--unchecked",!i),O()(t,"vue-switcher--disabled",r),O()(t,"vue-switcher--bold",s),O()(t,"vue-switcher--bold--unchecked",s&&!i),O()(t,"vue-switcher-theme--"+a,e),O()(t,"vue-switcher-color--"+e,e),t},shouldShowLabel:function(){return""!==this.label||""!==this.textEnabled||""!==this.textDisabled}}},E={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{class:t.classObject},[t.shouldShowLabel?i("span",{staticClass:"vue-switcher__label"},[t.label?i("span",{domProps:{textContent:t._s(t.label)}}):t._e(),t._v(" "),!t.label&&t.value?i("span",{domProps:{textContent:t._s(t.textEnabled)}}):t._e(),t._v(" "),t.label||t.value?t._e():i("span",{domProps:{textContent:t._s(t.textDisabled)}})]):t._e(),t._v(" "),i("input",{attrs:{type:"checkbox",disabled:t.disabled},domProps:{checked:t.value},on:{change:t.trigger}}),t._v(" "),i("div")])},staticRenderFns:[]};var F=i("VU/8")(V,E,!1,function(t){i("fYSq")},null,null).exports,Z={scaleStage:function(t,e,i){var a=this.stage.scaleX(),s=e/a-this.stage.x()/a,r=i/a-this.stage.y()/a,o=t>0?a*this.zoomStep:a/this.zoomStep,n=o<this.minZoomScale?this.minZoomScale:o>this.maxZoomScale?this.maxZoomScale:o;this.stage.scale({x:n,y:n});var l={x:-(s-e/n)*n,y:-(r-i/n)*n};this.stage.position(l),this.redrawGrid(),this.stage.batchDraw(),this.zoomLevel=parseFloat(Math.round(100*n)/100).toFixed(2)},performZoom:function(t){t.stopPropagation(),t.preventDefault();var e=t.wheelDeltaY||-t.deltaY,i=this.stage.getPointerPosition();this.scaleStage(e,i.x,i.y)},performZoomTouch:function(t){if(2===t.targetTouches.length){t.stopPropagation(),t.preventDefault();var e=t.targetTouches[0],i=t.targetTouches[1],a=Math.sqrt(Math.pow(e.clientX-i.clientX,2)+Math.pow(e.clientY-i.clientY,2));if(this.lastTouchDistance){var s=a-this.lastTouchDistance,r={x:(e.clientX+i.clientX)/2,y:(e.clientY+i.clientY)/2},o=this.stage.attrs.container.getBoundingClientRect(),n={x:r.x-o.x,y:r.y-o.y};this.scaleStage(s,n.x,n.y)}else this.lastTouchDistance=a}}},G=i("fZjL"),H=i.n(G),z=i("BO1k"),Y=i.n(z),X={drive:function(){var t="live"===this.viewDataSource?this.liveStats:this.replay.activeFrame;t&&(this.animateVehicle(t.vehicleX,t.vehicleY),this.animateObservations(t.observations),this.animateClusters(t.clusters),this.animateTrajectory(t.trajectory,t.trajectoryHash))},animateVehicle:function(t,e){if(this.shapeVehicle){var i={x:t,y:e};if(i.x!==this.lastKnownVehiclePosition.x||i.y!==this.lastKnownVehiclePosition.y){this.shapeVehicle.position({x:Object(d.meterToPixels)(i.x),y:Object(d.meterToPixels)(i.y)});var a={x:i.x-this.lastKnownVehiclePosition.x,y:i.y-this.lastKnownVehiclePosition.y},s=Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2)),r=a.x/s,o=Math.acos(r)*(180/Math.PI),n=a.y>=0?o:360-o;"replay"===this.viewDataSource&&this.replay.delta<0&&(n=(n+180)%360),this.shapeVehicle.rotation(n),this.lastKnownVehiclePosition.x=i.x,this.lastKnownVehiclePosition.y=i.y}}},animateObservations:function(t){var e=[],i=!0,a=!1,s=void 0;try{for(var r,o=Y()(t);!(i=(r=o.next()).done);i=!0){var n=r.value;e.push(new k.a.Circle({x:Object(d.meterToPixels)(n.x),y:Object(d.meterToPixels)(n.y),radius:Object(d.meterToPixels)(.2),fill:"black"}))}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}var l=!0,c=!1,h=void 0;try{for(var u,p=Y()(this.observationsShapes);!(l=(u=p.next()).done);l=!0){u.value.destroy()}}catch(t){c=!0,h=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw h}}var g=!0,v=!1,f=void 0;try{for(var m,b=Y()(e);!(g=(m=b.next()).done);g=!0){var y=m.value;this.observationsLayer.add(y)}}catch(t){v=!0,f=t}finally{try{!g&&b.return&&b.return()}finally{if(v)throw f}}this.observationsShapes=e,this.observationsLayer.draw()},animateClusters:function(t){for(var e in t){var i=t[e],a={x:Object(d.meterToPixels)(i.middleX),y:Object(d.meterToPixels)(i.middleY)},s=Object(d.meterToPixels)(Math.max(i.width,i.height)),r=this.isInVisibleWorld(a,s),o=this.clusterShapes.hasOwnProperty(e);if(r)if(o){if(i.hash!==this.clusterHashes[e]){this.clusterShapes[e].position({x:Object(d.meterToPixels)(i.middleX),y:Object(d.meterToPixels)(i.middleY)}),this.clusterShapes[e].rotation=i.angle;for(var n=this.clusterShapes[e].getChildren(),l=n.length;l>0;l--)n[l-1].size({width:Object(d.meterToPixels)(i.width*l),height:Object(d.meterToPixels)(i.height*l)})}}else{for(var c=new k.a.Group({x:Object(d.meterToPixels)(i.middleX),y:Object(d.meterToPixels)(i.middleY),rotation:i.angle}),h=[3,2,1],u=0;u<h.length;u++){var p=h[u];c.add(new k.a.Ellipse({width:Object(d.meterToPixels)(i.width*p),height:Object(d.meterToPixels)(i.height*p),fill:0===i.color?"yellow":"blue",opacity:.5}))}this.clusterShapes[e]=c,this.clusterLayer.add(c)}else o&&(this.clusterShapes[e].destroyChildren(),this.clusterShapes[e].destroy(),delete this.clusterShapes[e]);this.clusterHashes[e]=i.hash}for(var g in this.clusterShapes)t.hasOwnProperty(g)||(this.clusterShapes[g].destroy(),delete this.clusterShapes[g]);this.clusterLayer.batchDraw()},animateTrajectory:function(t,e){if(e!==this.lastKnownTrajectoryHash){var i=t.map(function(t){return Object(d.meterToPixels)(t)});this.shapeTrajectory.points(i),this.lastKnownTrajectoryHash=e,this.trajectoryLayer.batchDraw()}},animateStage:function(){if(null!==this.stage&&null!==this.shapeVehicle){var t=this.stage.scaleX(),e={x:this.stage.width(),y:this.stage.height()},i={x:this.shapeVehicle.x(),y:this.shapeVehicle.y()},a={x:i.x*t,y:i.y*t},s={x:this.stage.x(),y:this.stage.y()},r={x:-s.x,y:-s.y},o={x:r.x+e.x/2,y:r.y+e.y/2},n={x:a.x-o.x,y:a.y-o.y};this.stage.move({x:-n.x,y:-n.y}),this.redrawGrid(),this.stage.batchDraw()}},redrawGrid:function(){var t=this,e=this.getVisibleWorldDimensions();if(this.shapeXAxis.points([e.x,0,e.x+e.width,0]),this.shapeYAxis.points([0,e.y,0,e.y+e.height]),this.zoomLevel>.5){var i={x:100*Math.round(e.x/100)-100,y:100*Math.round(e.y/100)-100};this.shapeGrid.setPosition(i),this.shapeGrid.setSize({width:e.width+200,height:e.height+200}),this.shapeGrid.show()}else this.shapeGrid.hide();for(var a=e.x%100,s=e.y%100,r=Math.round(e.x-a-100),o=Math.round(e.y-s-100),n=r;n<e.x+e.width;n+=100)if(!this.xAxisLabels[n]&&0!==n){var l=new k.a.Text({x:n,y:3,text:Object(d.pixelToMeters)(n).toString(),fontSize:20,fontFamily:"Verdana",fill:"black",align:"center"});l.offsetX(l.width()/2),this.gridLayer.add(l),this.xAxisLabels[n]=l}for(var c=o;c<e.y+e.height;c+=100)if(!this.yAxisLabels[c]&&0!==c){var h=new k.a.Text({x:0,y:c,text:Object(d.pixelToMeters)(c).toString(),fontSize:20,fontFamily:"Verdana",fill:"black",align:"center"});h.x(-5-h.width()),h.offsetY(h.height()/2),this.gridLayer.add(h),this.yAxisLabels[c]=h}H()(this.xAxisLabels).filter(function(t){return t<r-100||t>e.x+e.width+100}).forEach(function(e){t.xAxisLabels[e].destroy(),delete t.xAxisLabels[e]}),H()(this.yAxisLabels).filter(function(t){return t<o-100||t>e.x+e.width+100}).forEach(function(e){t.yAxisLabels[e].destroy(),delete t.yAxisLabels[e]})}},W={getVisibleWorldDimensions:function(){var t=this.stage.scale();return{x:-this.stage.x()/t.x,y:-this.stage.y()/t.y,width:this.stage.width()/t.x,height:this.stage.height()/t.y}},isInVisibleWorld:function(t,e){if("object"!==(void 0===t?"undefined":c()(t))||!t.hasOwnProperty("x")||!t.hasOwnProperty("y"))throw new Error("ViewportUtil: `position` does not match the specification");if(e&&"number"!=typeof e)throw new Error("ViewportUtil: `additionalMargin` must be a number");var i=this.getVisibleWorldDimensions(),a=e||0,s={min:i.x-a,max:i.x+i.width+a},r={min:i.y-a,max:i.y+i.height+a};return t.x>=s.min&&t.x<=s.max&&t.y>=r.min&&t.y<=r.max}},N={name:"Map",data:function(){return{lastKnownVehiclePosition:{x:0,y:0},stage:null,gridLayer:null,shapeGrid:null,shapeXAxis:null,shapeYAxis:null,xAxisLabels:{},yAxisLabels:{},vehicleLayer:null,shapeVehicle:null,clusterLayer:null,clusterBaseCircles:{},clusterShapes:{},clusterHashes:{},observationsLayer:null,observationsShapes:[],trajectoryLayer:null,shapeTrajectory:null,lastKnownTrajectoryHash:0,animationStage:null,animationVehicle:null,animationTrack:null,animationMiddlePath:null,zoomStep:1.1,lastTouchDistance:null,minZoomScale:.15,maxZoomScale:5,zoomLevel:1,showVehicle:!0,showTrack:!0,showMiddlePath:!0,showGrid:!0,focusVehicle:!0}},computed:S()({},Object(n.b)(["liveStats","replay","viewDataSource"])),watch:{focusVehicle:function(t){this.animationStage&&(t?this.animationStage.start():this.animationStage.stop())},showGrid:function(t){this.gridLayer&&(t?this.gridLayer.show():this.gridLayer.hide())}},mounted:function(){var t=this,e=this.$el.querySelector("#mapWrapper");this.stage=new k.a.Stage({container:"mapWrapper",draggable:!0,width:e.offsetWidth,height:500}),this.clusterBaseCircles={yellow:[new k.a.Circle({radius:1,fill:"yellow",opacity:.5}),new k.a.Circle({radius:2,fill:"yellow",opacity:.5}),new k.a.Circle({radius:3,fill:"yellow",opacity:.5}),new k.a.Circle({radius:4,fill:"yellow",opacity:.5})],blue:[new k.a.Circle({radius:1,fill:"blue",opacity:.5}),new k.a.Circle({radius:2,fill:"blue",opacity:.5}),new k.a.Circle({radius:3,fill:"blue",opacity:.5}),new k.a.Circle({radius:4,fill:"blue",opacity:.5})]},this.gridLayer=new k.a.Layer,this.vehicleLayer=new k.a.Layer,this.clusterLayer=new k.a.Layer,this.observationsLayer=new k.a.Layer,this.trajectoryLayer=new k.a.Layer,this.stage.add(this.gridLayer),this.stage.add(this.vehicleLayer),this.stage.add(this.clusterLayer),this.stage.add(this.observationsLayer),this.stage.add(this.trajectoryLayer),this.showGrid||this.gridLayer.hide(),this.shapeXAxis=new k.a.Line({points:[0,2e3,0,-2e3],stroke:"red",strokeWidth:3}),this.shapeYAxis=new k.a.Line({points:[2e3,0,-2e3,0],stroke:"green",strokeWidth:3}),this.gridLayer.add(this.shapeXAxis,this.shapeYAxis);var i=new Image;i.onload=function(){this.shapeGrid=new k.a.Rect({fillPatternImage:i,fillPatternRepeat:"repeat",height:500,width:e.offsetWidth}),this.gridLayer.add(this.shapeGrid)}.bind(this),i.src="/static/grid.png",k.a.Image.fromURL("/static/pwd.png",function(e){e.size({width:Object(d.meterToPixels)(2.925),height:Object(d.meterToPixels)(1.395)}),e.offsetX(e.width()/2),e.offsetY(e.height()/2),e.position({x:Object(d.meterToPixels)(t.liveStats.vehicleX),y:Object(d.meterToPixels)(t.liveStats.vehicleY)}),t.shapeVehicle=e,t.vehicleLayer.add(e),t.animateStage()}),this.shapeTrajectory=new k.a.Line({points:[],stroke:"red",strokeWidth:4}),this.trajectoryLayer.add(this.shapeTrajectory),this.animationVehicle=new k.a.Animation(this.drive,[this.vehicleLayer,this.clusterLayer,this.observationsLayer,this.trajectoryLayer]),this.animationStage=new k.a.Animation(this.animateStage),this.animationVehicle.start(),this.focusVehicle&&this.animationStage.start(),this.stage.on("dragmove",function(e){t.showGrid&&t.redrawGrid()}),this.stage.attrs.container.addEventListener("mousewheel",this.performZoom.bind(this)),this.stage.attrs.container.addEventListener("wheel",this.performZoom.bind(this)),this.stage.attrs.container.addEventListener("touchmove",this.performZoomTouch),this.stage.attrs.container.addEventListener("touchend",function(e){t.lastTouchDistance=null}),window.addEventListener("load",this.resizeCanvas.bind(this)),window.addEventListener("resize",this.resizeCanvas.bind(this))},methods:S()({resizeCanvas:function(){this.stage.width(this.$el.querySelector("#mapWrapper").offsetWidth)}},Z,X,W),components:{Switches:F}},$={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-row",[i("b-col",[i("div",{attrs:{id:"mapWrapper"}})])],1),t._v(" "),i("b-row",{staticClass:"mapControls",attrs:{"align-h":"center"}},[i("b-col",{staticClass:"controlsCol",attrs:{cols:"auto",sm:"auto"}},[i("div",{staticClass:"controlsFrame"},[i("switches",{attrs:{theme:"fsd",label:"Show Grid"},model:{value:t.showGrid,callback:function(e){t.showGrid=e},expression:"showGrid"}})],1)]),t._v(" "),i("b-col",{staticClass:"controlsCol",attrs:{cols:"auto",sm:"auto"}},[i("div",{staticClass:"controlsFrame"},[i("label",[t._v("Zoom Level")]),t._v(" "),i("code",[t._v(t._s(t.zoomLevel))])])]),t._v(" "),i("b-col",{staticClass:"controlsCol",attrs:{cols:"auto",sm:"auto"}},[i("div",{staticClass:"controlsFrame"},[i("switches",{attrs:{theme:"fsd",label:"Focus Vehicle"},model:{value:t.focusVehicle,callback:function(e){t.focusVehicle=e},expression:"focusVehicle"}})],1)])],1)],1)},staticRenderFns:[]};var B=i("VU/8")(N,$,!1,function(t){i("SXNU")},null,null).exports,U={name:"DashboardView",data:function(){return{transportMode:"live",transportPosition:0,activeClip:null}},computed:Object(n.b)({liveStats:"liveStats"}),watch:{$route:function(t,e){t.path.split("/").indexOf("live")>=0&&this.$store.dispatch("startRefreshingEntity","liveStats")}},created:function(){this.$route.path.split("/").indexOf("live")>=0&&this.$store.dispatch("startRefreshingEntity","liveStats")},destroyed:function(){this.$store.dispatch("stopRefreshingEntity","liveStats")},components:{RecordingControls:C,ReplayControls:A,Map:B}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("router-view",{attrs:{name:"transportControls"}}),this._v(" "),e("router-view",{attrs:{name:"map"}}),this._v(" "),e("router-view",{attrs:{name:"cards"}})],1)},staticRenderFns:[]},q=i("VU/8")(U,K,!1,null,null,null).exports,J={name:"RecordingsView",data:function(){return{loading:!1,fields:[{key:"_id",label:"ID"},{key:"start",label:"Started at",formatter:function(t,e,i){var a=new Date(t);return h.a.padZeros(2,a.getDate())+"."+h.a.padZeros(2,a.getMonth())+"."+a.getFullYear()+" - "+h.a.padZeros(2,a.getHours())+":"+h.a.padZeros(2,a.getMinutes())+":"+h.a.padZeros(2,a.getSeconds())}},{key:"duration",label:"Duration",formatter:function(t,e,i){return i.end?h.a.timerFormat(i.end-i.start):"- not finished -"}}]}},computed:Object(n.b)({recordings:"recordings"}),mounted:function(){this.reload()},methods:{reload:function(){var t=this;this.loading=!0,this.$store.dispatch("fetchRecordings").then(function(e){t.loading=!1},function(t){console.log(t)})}}},Q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",[a("h1",[t._v("Select a clip to replay")])])],1),t._v(" "),a("b-row",{attrs:{"align-h":"between"}},[a("b-col",{attrs:{"align-self":"center"}},[t.loading?a("b-progress",{attrs:{max:100,height:"20px",variant:"fsd-red",animated:""}},[a("b-progress-bar",{attrs:{value:100}},[a("strong",[t._v("Loading clips...")])])],1):t._e()],1),t._v(" "),a("b-col",{attrs:{cols:"auto"}},[a("b-button",{attrs:{variant:"secondary",disabled:t.loading},on:{click:t.reload}},[a("img",{attrs:{src:i("IXiI"),width:"16"}})])],1)],1),t._v(" "),a("b-row",[a("b-col",[a("b-table",{attrs:{items:t.recordings,fields:t.fields,id:"clipList","thead-class":"thead-fsd","tbody-class":"tbody-fsd",hover:"",fixed:""},scopedSlots:t._u([{key:"_id",fn:function(e){return a("span",{},[a("router-link",{attrs:{to:"/dashboard/replay/"+e.value}},[t._v(t._s(e.value))])],1)}}])})],1)],1)],1)},staticRenderFns:[]};var tt=i("VU/8")(J,Q,!1,function(t){i("d/ak")},null,null).exports,et={name:"CardsLive",data:function(){return{}},computed:Object(n.b)({liveStats:"liveStats",liveStatsFiltered:function(){var t=p.a.getConfigFromIdentifier("liveStats").requiredProperties,e=this.liveStats,i={};for(var a in e)t.indexOf(a)>=0&&(i[a]=e[a]);return i}})},it={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-row",[i("b-col",{attrs:{md:"6",lg:"4"}},[i("b-card",{attrs:{title:"Live stats"}},[i("p",{staticClass:"card-text"},[i("pre",[t._v("timestamp: "+t._s(t.liveStatsFiltered.timestamp)+"\nsteerAngle: "+t._s(t.liveStatsFiltered.steerAngle)+"\npathMiddleX: "+t._s(t.liveStatsFiltered.pathMiddleX)+"\npathMiddleY: "+t._s(t.liveStatsFiltered.pathMiddleY)+"\nvehicleX: "+t._s(t.liveStatsFiltered.vehicleX)+"\nvehicleY: "+t._s(t.liveStatsFiltered.vehicleY)+"\nvehicleVelocityX: "+t._s(t.liveStatsFiltered.vehicleVelocityX)+"\nvehicleVelocityY: "+t._s(t.liveStatsFiltered.vehicleVelocityY)+"\nvehicleRotation: "+t._s(t.liveStatsFiltered.vehicleRotation)+"\nfrontwheelLeftRotation: "+t._s(t.liveStatsFiltered.frontwheelLeftRotation)+"\nfrontwheelRightRotation: "+t._s(t.liveStatsFiltered.frontwheelRightRotation)+"\n        ")])])])],1),t._v(" "),i("b-col",{attrs:{md:"6",lg:"4"}},[i("b-card",{attrs:{title:"Observations"}},[i("p",{staticClass:"card-text"},[i("pre",[t._v(t._s(t.liveStatsFiltered.observations))])])])],1),t._v(" "),i("b-col",{attrs:{md:"6",lg:"4"}},[i("b-card",{attrs:{title:"Trajectory"}},[i("p",{staticClass:"card-text"},[i("pre",[t._v(t._s(t.liveStatsFiltered.trajectory))])])])],1)],1)},staticRenderFns:[]},at=i("VU/8")(et,it,!1,null,null,null).exports,st={name:"CardsReplay",data:function(){return{}},computed:Object(n.b)({replayGlobals:"replay"})},rt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("b-row",[e("b-card-group",{attrs:{columns:""}},[e("b-card",{attrs:{title:"Stats"}},[e("p",{staticClass:"card-text"},[e("code",[this._v("\n          "+this._s(this.replayGlobals.activeFrame)+"\n        ")])])])],1)],1)},staticRenderFns:[]},ot=i("VU/8")(st,rt,!1,null,null,null).exports;a.a.use(o.a);var nt=new o.a({routes:[{path:"/",redirect:"/dashboard/live"},{path:"/dashboard",name:"dashboard",component:q,props:{recording:!0},children:[{path:"live",components:{transportControls:C,map:B,cards:at}},{path:"replay/:clipID",components:{transportControls:A,map:B,cards:ot},props:{transportControls:!0}}]},{path:"/recordings",name:"recordings",component:tt}]});nt.beforeEach(function(t,e,i){t.path.split("/").indexOf("live")>=0?w.commit("updateViewDataSource","live"):w.commit("updateViewDataSource","replay"),i()});var lt=nt,ct={name:"status-light",props:{active:Boolean,label:String,color:String},computed:{style:function(){return this.active?"background-color: "+this.color+";":"background: transparent; border: 1px solid gray;"}}},dt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",[this._v(this._s(this.label))]),this._v(" "),e("span",{style:this.style,attrs:{id:"light"}})])},staticRenderFns:[]};var ht=i("VU/8")(ct,dt,!1,function(t){i("N3eC")},"data-v-f610b894",null).exports,ut={name:"App",data:function(){return{}},computed:Object(n.b)({appState:"appState",globalLoader:"globalLoader"}),created:function(){this.$store.dispatch("startRefreshingEntity","appState")},methods:{resetStats:function(){var t=this;this.$store.commit("updateGlobalLoader",{show:!0,message:"Resetting stats..."}),this.$store.dispatch("resetStats").then(function(e){t.$store.commit("updateGlobalLoader",{show:!1,message:""})},function(t){console.log(t)})}},components:{StatusLight:ht}},pt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"fsd"}},[a("b-navbar-toggle",{attrs:{target:"navbarCollapse"}}),t._v(" "),a("b-navbar-brand",{attrs:{href:"/#/"}},[t._v("Driverless Cockpit")]),t._v(" "),a("b-collapse",{attrs:{"is-nav":"",id:"navbarCollapse"}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/recordings"}},[a("b-button",{attrs:{variant:"primary",size:"sm"}},[a("img",{staticClass:"nav-icon",attrs:{src:i("qltc"),width:"10"}}),t._v(" Replay\n          ")])],1),t._v(" "),a("b-nav-item",{on:{click:t.resetStats}},[a("b-button",{attrs:{variant:"outline-neutral",size:"sm"}},[a("img",{staticClass:"nav-icon",attrs:{src:i("Gjb1"),width:"10"}}),t._v(" Reset stats\n          ")])],1)],1),t._v(" "),a("b-navbar-nav",{staticClass:"ml-auto"},[a("b-nav-item",{attrs:{to:"/dashboard/live"}},[a("status-light",{attrs:{label:"Recording",active:t.appState.recording,color:"rgba(190,22,33,1)"}})],1),t._v(" "),a("b-nav-item",[a("status-light",{attrs:{label:"Connected",active:t.appState.connected,color:"lightgreen"}})],1)],1)],1)],1),t._v(" "),a("b-container",[a("router-view")],1),t._v(" "),a("b-modal",{ref:"globalLoader",attrs:{"no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":""},model:{value:t.globalLoader.show,callback:function(e){t.$set(t.globalLoader,"show",e)},expression:"globalLoader.show"}},[a("div",{attrs:{slot:"modal-header"},slot:"modal-header"}),t._v(" "),a("h3",[t._v(t._s(t.globalLoader.message))]),t._v(" "),a("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"})])],1)},staticRenderFns:[]};var gt=i("VU/8")(ut,pt,!1,function(t){i("NRio")},null,null).exports;i("Jmt5"),i("9M+g"),i("Fphx");a.a.config.productionTip=!1,a.a.use(s.a),a.a.use(r.a),a.a.http.options.root="/",new a.a({el:"#app",store:w,router:lt,components:{App:gt},template:"<App/>"})},NRio:function(t,e){},SXNU:function(t,e){},V8gR:function(t,e){var i={requiredProperties:["activeRecording","connected","recording","presentationMode"],refreshInterval:500},a={requiredProperties:["timestamp","steerAngle","pathMiddleX","pathMiddleY","vehicleX","vehicleY","vehicleVelocityX","vehicleVelocityY","vehicleRotation","frontwheelLeftRotation","frontwheelRightRotation","observations","clusters","trajectory","trajectoryHash","trajectoryPrimitives"],refreshInterval:100};t.exports={getStateObjectFromIdentifier:function(t,e){switch(e){case"appState":return t.appState;case"liveStats":return t.liveStats;default:throw new Error("Unknown entity identifier: "+e)}},getApiRouteFromIdentifier:function(t){switch(t){case"appState":return"appstate";case"liveStats":return"livestats";case"start":return"recording/start";case"stop":return"recording/stop";case"resetStats":return"resetstats";default:throw new Error("Unknown entity identifier: "+t)}},getConfigFromIdentifier:function(t){switch(t){case"appState":return i;case"liveStats":return a;default:throw new Error("Unknown entity identifier: "+t)}}}},XySv:function(t,e){},"d/ak":function(t,e){},fYSq:function(t,e){},frZY:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIKICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgoKICA8bGluZSB4MT0iMSIgeTE9IjEiIHgyPSIxMSIgeTI9IjExIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIC8+CiAgPGxpbmUgeDE9IjExIiB5MT0iMSIgeDI9IjEiIHkyPSIxMSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiAvPgo8L3N2Zz4K"},qltc:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIKICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgoKICA8cG9seWdvbiBwb2ludHM9IjAsMCAxMSw2IDAsMTIiIGZpbGw9IndoaXRlIiBzdHJva2UtbGluZWpvaW49Im1pdGVyIi8+Cjwvc3ZnPgo="},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.8afbedd72822ca0c6b8d.js.map